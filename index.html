<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–∫–∏ - –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</title>
    
    <!-- Telegram Web App Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--tg-theme-bg-color, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
            color: var(--tg-theme-text-color, #333);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }

        /* Telegram Web App –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        body.telegram-app {
            background: var(--tg-theme-bg-color);
            padding: 10px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--tg-theme-secondary-bg-color, white);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .telegram-app .container {
            border-radius: 10px;
            box-shadow: none;
        }

        .header {
            background: var(--tg-theme-button-color, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
            color: var(--tg-theme-button-text-color, white);
            padding: 40px 30px;
            text-align: center;
        }

        .telegram-app .header {
            padding: 20px 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .telegram-app .header h1 {
            font-size: 1.8em;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .telegram-app .header p {
            font-size: 1em;
        }

        .content {
            padding: 40px 30px;
        }

        .telegram-app .content {
            padding: 20px 15px;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .asset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .telegram-app .asset-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .asset-card {
            background: var(--tg-theme-bg-color, linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%));
            border: 2px solid var(--tg-theme-hint-color, transparent);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: var(--tg-theme-text-color, #333);
        }

        .telegram-app .asset-card {
            padding: 20px;
            border-radius: 10px;
        }

        .asset-card:hover {
            transform: translateY(-5px);
            border-color: var(--tg-theme-button-color, #667eea);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .asset-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .telegram-app .asset-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .asset-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .telegram-app .asset-title {
            font-size: 1.1em;
        }

        .asset-description {
            font-size: 0.9em;
            opacity: 0.8;
            line-height: 1.4;
        }

        .telegram-app .asset-description {
            font-size: 0.8em;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 30px 0;
            padding: 0 10px;
        }

        .btn {
            background: var(--tg-theme-button-color, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
            color: var(--tg-theme-button-text-color, white);
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            display: inline-block;
            text-decoration: none;
        }

        .telegram-app .btn {
            padding: 12px 20px;
            font-size: 1em;
            margin: 8px;
            border-radius: 10px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            opacity: 0.9;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--tg-theme-hint-color, linear-gradient(135deg, #6c757d 0%, #495057 100%));
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-telegram {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
        }

        .btn-action {
            padding: 18px 15px;
            font-size: 0.95em;
            border-radius: 12px;
            margin: 0;
            text-align: center;
            line-height: 1.2;
        }

        .btn-back {
            grid-column: 1 / -1;
            margin-top: 10px;
            padding: 12px 20px;
            font-size: 0.9em;
        }

        .telegram-app .btn-action {
            padding: 15px 12px;
            font-size: 0.9em;
        }

        .email-form {
            background: var(--tg-theme-bg-color, #f8f9fa);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border: 1px solid var(--tg-theme-hint-color, #e9ecef);
        }

        .telegram-app .email-form {
            padding: 20px;
            border-radius: 10px;
        }

        .email-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid var(--tg-theme-hint-color, #e9ecef);
            border-radius: 10px;
            font-size: 1.1em;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
            background: var(--tg-theme-bg-color, white);
            color: var(--tg-theme-text-color, #333);
        }

        .telegram-app .email-input {
            padding: 12px 15px;
            font-size: 1em;
            border-radius: 8px;
        }

        .email-input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color, #667eea);
        }

        .info-box {
            background: var(--tg-theme-bg-color, #e3f2fd);
            border-left: 4px solid var(--tg-theme-button-color, #2196f3);
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            color: var(--tg-theme-text-color, #333);
        }

        .telegram-app .info-box {
            padding: 15px;
            margin: 15px 0;
        }

        .success-box {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .telegram-app .success-box {
            padding: 15px;
            margin: 15px 0;
        }

        .error-box {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .progress-bar {
            height: 4px;
            background: var(--tg-theme-hint-color, #e9ecef);
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
        }

        .telegram-app .progress-bar {
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--tg-theme-button-color, linear-gradient(90deg, #667eea 0%, #764ba2 100%));
            width: 0%;
            transition: width 0.5s ease;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .telegram-app .step-indicator {
            margin: 20px 0;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--tg-theme-hint-color, #e9ecef);
            margin: 0 5px;
            transition: background 0.3s ease;
        }

        .step-dot.active {
            background: var(--tg-theme-button-color, #667eea);
        }

        .footer {
            background: var(--tg-theme-secondary-bg-color, #f8f9fa);
            padding: 30px;
            text-align: center;
            border-top: 1px solid var(--tg-theme-hint-color, #e9ecef);
            color: var(--tg-theme-hint-color, #6c757d);
        }

        .telegram-app .footer {
            padding: 20px;
        }

        .footer p {
            margin: 5px 0;
        }

        .telegram-indicator {
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, white);
            padding: 10px;
            text-align: center;
            font-size: 0.9em;
            display: none;
        }

        .telegram-app .telegram-indicator {
            display: block;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .telegram-app .container {
                margin: 5px;
                border-radius: 10px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .telegram-app .header {
                padding: 15px 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .telegram-app .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .telegram-app .content {
                padding: 15px 10px;
            }
            
            .asset-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--tg-theme-button-text-color, #ffffff);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä Telegram -->
    <div class="telegram-indicator">
        ü§ñ –ó–∞–ø—É—â–µ–Ω–æ –≤ Telegram Web App
    </div>

    <div class="container">
        <div class="header">
            <h1>ü§ñ –î–æ–∫–∏</h1>
            <p>–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –∑–∞–ª–æ–≥–æ–≤–æ–π —Å–ª—É–∂–±—ã</p>
        </div>

        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —à–∞–≥–æ–≤ -->
        <div class="step-indicator">
            <div class="step-dot active" data-step="1"></div>
            <div class="step-dot" data-step="2"></div>
            <div class="step-dot" data-step="3"></div>
        </div>

        <div class="content">
            <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–∞ -->
            <div class="step active" id="step1">
                <h2 style="text-align: center; margin-bottom: 30px;">üè¢ –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–∫—Ç–∏–≤–∞</h2>
                
                <div class="asset-grid" id="assetGrid">
                    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∞–∫—Ç–∏–≤–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>

            <!-- –®–∞–≥ 2: –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="step" id="step2">
                <div id="selectedAssetInfo"></div>

                <div class="action-buttons">
                    <button class="btn btn-telegram btn-action" onclick="downloadDocumentDirect()">
                        üìÑ –°–∫–∞—á–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
                    </button>
                    <button class="btn btn-telegram btn-action" onclick="showEmailForm()">
                        üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ email
                    </button>
                    <button class="btn btn-secondary btn-back" onclick="goBack()">
                        üîô –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É
                    </button>
                </div>

                <!-- –§–æ—Ä–º–∞ email —Å Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π -->
                <div class="email-form hidden" id="emailForm">
                    <h3>üìß –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ email</h3>
                    <p>–î–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞:</p>
                    
                    <input type="email" class="email-input" id="emailInput" 
                           placeholder="example@mail.ru" required>
                    
                    <div style="text-align: center;">
                        <button class="btn btn-success" onclick="sendEmailViaTelegram()">
                            <span id="sendBtnText">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞</span>
                            <span class="loading hidden" id="sendLoading"></span>
                        </button>
                        <button class="btn btn-secondary" onclick="hideEmailForm()">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>

                    <div class="info-box" style="margin-top: 15px;">
                        <p><strong>üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                        <p>‚Ä¢ Telegram –±–æ—Ç –ø–æ–ª—É—á–∏—Ç –≤–∞—à –∑–∞–ø—Ä–æ—Å</p>
                        <p>‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ Mail.ru</p>
                        <p>‚Ä¢ –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —á–∞—Ç–µ</p>
                    </div>
                </div>
            </div>

            <!-- –®–∞–≥ 3: –†–µ–∑—É–ª—å—Ç–∞—Ç -->
            <div class="step" id="step3">
                <div id="resultMessage"></div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-telegram" onclick="restart()">
                        üîÑ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –∞–∫—Ç–∏–≤
                    </button>
                    <button class="btn btn-secondary" onclick="goBack()">
                        üîô –ù–∞–∑–∞–¥
                    </button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>ü§ñ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–î–æ–∫–∏" –¥–ª—è Telegram</p>
            <p>üìß –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º: docs_zs@mail.ru</p>
            <p>¬© 2024 –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∑–∞–ª–æ–≥–æ–≤–∞—è —Å–ª—É–∂–±–∞</p>
        </div>
    </div>

    <script>
        // Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const tg = window.Telegram?.WebApp;
        let isInTelegram = !!tg;

        // –ß–ò–°–¢–´–ï –¥–∞–Ω–Ω—ã–µ –æ–± –∞–∫—Ç–∏–≤–∞—Ö (–ë–ï–ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Å—Ä–æ–∫–æ–≤!)
        const ASSETS = {
            '–±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä': {
                icon: 'üè¢',
                title: '–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä',
                description: '–û—Ñ–∏—Å–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä—ã',
                filename: '–ë–¶.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ë–¶.docx'
            },
            '—Ç–æ—Ä–≥–æ–≤—ã–π-—Ü–µ–Ω—Ç—Ä': {
                icon: 'üõçÔ∏è',
                title: '–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä',
                description: '–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ –∫–æ–º–ø–ª–µ–∫—Å—ã',
                filename: '–¢–¶.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–¢–¶.docx'
            },
            '—Å–∫–ª–∞–¥—Å–∫–æ–π-–∫–æ–º–ø–ª–µ–∫—Å': {
                icon: 'üì¶',
                title: '–°–∫–ª–∞–¥—Å–∫–æ–π –∫–æ–º–ø–ª–µ–∫—Å',
                description: '–°–∫–ª–∞–¥—Å–∫–∏–µ –ø–æ–º–µ—â–µ–Ω–∏—è –∏ –∫–æ–º–ø–ª–µ–∫—Å—ã',
                filename: '–°–∫–ª–∞–¥.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–°–∫–ª–∞–¥.docx'
            },
            '–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞': {
                icon: 'üè®',
                title: '–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞',
                description: '–ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã',
                filename: '–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ì–æ—Å—Ç–∏–Ω–∏—Ü–∞.docx'
            },
            '–±–∏–∑–Ω–µ—Å': {
                icon: 'üíº',
                title: '–ë–∏–∑–Ω–µ—Å',
                description: '–î–æ–ª–∏ –≤ –±–∏–∑–Ω–µ—Å–µ –∏ –∞–∫—Ü–∏–∏',
                filename: '–ë–∏–∑–Ω–µ—Å_–ö–ò.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ë–∏–∑–Ω–µ—Å_–ö–ò.docx'
            },
            '–∫–æ–º–ø–ª–µ–∫—Å-–∏–º—É—â–µ—Å—Ç–≤–∞': {
                icon: 'üèóÔ∏è',
                title: '–ö–æ–º–ø–ª–µ–∫—Å –∏–º—É—â–µ—Å—Ç–≤–∞',
                description: '–ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã',
                filename: '–ë–∏–∑–Ω–µ—Å_–ö–ò.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ë–∏–∑–Ω–µ—Å_–ö–ò.docx'
            },
            '–º–∞—à–∏–Ω—ã-–∏-–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': {
                icon: '‚öôÔ∏è',
                title: '–ú–∞—à–∏–Ω—ã –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
                description: '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
                filename: '–ú–∏–û.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ú–∏–û.docx'
            },
            '–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–ø—Ä–∞–≤–∞-–Ω–∞-–∂–∏–ª—å–µ': {
                icon: 'üè†',
                title: '–ò–ü–° –Ω–∞ –∂–∏–ª—å–µ',
                description: '–ü—Ä–∞–≤–∞ –Ω–∞ –∂–∏–ª—É—é –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å',
                filename: '–ò–ü–°_–∂–∏–ª—å–µ.docx',
                url: 'https://github.com/11021983A/Docky/raw/main/–ò–ü–°_–∂–∏–ª—å–µ.docx'
            }
        };

        let currentStep = 1;
        let selectedAsset = null;
        let stats = JSON.parse(localStorage.getItem('docsStats') || '{"downloads": 0, "emails": 0}');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function init() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Web App
            if (isInTelegram) {
                document.body.classList.add('telegram-app');
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç–µ–º—É
                tg.ready();
                tg.expand();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
                tg.MainButton.setText('–ü–†–û–î–û–õ–ñ–ò–¢–¨');
                tg.MainButton.hide();
                
                console.log('Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', tg.initDataUnsafe?.user);
            }

            createAssetCards();
            updateProgress();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∞–∫—Ç–∏–≤—É
            const urlParams = new URLSearchParams(window.location.search);
            const preselectedAsset = urlParams.get('asset');
            if (preselectedAsset && ASSETS[preselectedAsset]) {
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤
                setTimeout(() => {
                    const card = document.querySelector(`[data-asset="${preselectedAsset}"]`);
                    if (card) {
                        selectAsset(preselectedAsset, card);
                    }
                }, 500);
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∞–∫—Ç–∏–≤–æ–≤ (–¢–û–õ–¨–ö–û –Ω—É–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
        function createAssetCards() {
            const grid = document.getElementById('assetGrid');
            grid.innerHTML = '';

            Object.entries(ASSETS).forEach(([key, asset]) => {
                const card = document.createElement('div');
                card.className = 'asset-card';
                card.setAttribute('data-asset', key);
                card.onclick = () => selectAsset(key, card);
                
                // –í–ù–ò–ú–ê–ù–ò–ï: –ù–ò–ö–ê–ö–ò–• documents –∏ processing!
                card.innerHTML = `
                    <div class="asset-icon">${asset.icon}</div>
                    <div class="asset-title">${asset.title}</div>
                    <div class="asset-description">${asset.description}</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–∞ - —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –¥–µ–π—Å—Ç–≤–∏—è–º
        function selectAsset(assetKey, cardElement) {
            selectedAsset = assetKey;
            
            // –°—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —à–∞–≥—É 2 –±–µ–∑ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
            currentStep = 2;
            showStep(currentStep);
            showSelectedAssetInfo();

            // Haptic feedback –¥–ª—è Telegram
            if (isInTelegram && tg.HapticFeedback) {
                tg.HapticFeedback.selectionChanged();
            }
        }

        // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
        function nextStep() {
            if (currentStep < 3) {
                currentStep++;
                showStep(currentStep);
                
                if (currentStep === 2) {
                    showSelectedAssetInfo();
                    
                    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –∫–Ω–æ–ø–∫–∏
                    if (isInTelegram) {
                        tg.MainButton.hide();
                    }
                }
            }

            // Haptic feedback
            if (isInTelegram && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        // –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É
        function goBack() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                hideEmailForm();
                
                if (currentStep === 1 && isInTelegram) {
                    if (selectedAsset) {
                        tg.MainButton.show();
                    } else {
                        tg.MainButton.hide();
                    }
                }
            }
        }

        // –ü–æ–∫–∞–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —à–∞–≥–∞
        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index < step);
            });
            
            updateProgress();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        function updateProgress() {
            const progress = ((currentStep - 1) / 2) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –∞–∫—Ç–∏–≤–µ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function showSelectedAssetInfo() {
            const asset = ASSETS[selectedAsset];
            const infoDiv = document.getElementById('selectedAssetInfo');
            
            // –í–ù–ò–ú–ê–ù–ò–ï: –¢–û–õ–¨–ö–û –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è!
            infoDiv.innerHTML = `
                <div class="info-box">
                    <h3>${asset.icon} ${asset.title}</h3>
                    <p>${asset.description}</p>
                    <p><strong>–§–∞–π–ª:</strong> ${asset.filename}</p>
                </div>
            `;
        }

        // –ü—Ä—è–º–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function downloadDocumentDirect() {
            const asset = ASSETS[selectedAsset];
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É GitHub –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            const downloadUrl = asset.url;
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É - GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ DOCX
            const link = document.createElement('a');
            link.href = downloadUrl;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            
            // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–æ–±–∞–≤–ª—è–µ–º download –∞—Ç—Ä–∏–±—É—Ç
            if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                link.download = asset.filename;
            }
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            stats.downloads++;
            saveStats();
            
            // –£–≤–µ–¥–æ–º–ª—è–µ–º Telegram
            if (isInTelegram) {
                tg.sendData(JSON.stringify({
                    action: 'download_completed',
                    asset_type: selectedAsset,
                    timestamp: new Date().toISOString()
                }));
                
                if (tg.HapticFeedback) {
                    tg.HapticFeedback.notificationOccurred('success');
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showResult('download');
        }

        // –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã email
        function showEmailForm() {
            document.getElementById('emailForm').classList.remove('hidden');
            
            // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ email –∏–∑ Telegram –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
            if (isInTelegram && tg.initDataUnsafe?.user?.email) {
                document.getElementById('emailInput').value = tg.initDataUnsafe.user.email;
            }
        }

        // –°–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã email
        function hideEmailForm() {
            document.getElementById('emailForm').classList.add('hidden');
            document.getElementById('emailInput').value = '';
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞
        async function sendEmailViaTelegram() {
            const emailInput = document.getElementById('emailInput');
            const email = emailInput.value.trim();
            
            if (!email || !validateEmail(email)) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram popup –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
                if (isInTelegram) {
                    tg.showPopup({
                        title: '–û—à–∏–±–∫–∞',
                        message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å',
                        buttons: [{type: 'ok'}]
                    });
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å');
                }
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const sendBtn = document.getElementById('sendBtnText');
            const loading = document.getElementById('sendLoading');
            sendBtn.classList.add('hidden');
            loading.classList.remove('hidden');
            
            try {
                if (isInTelegram) {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram –±–æ—Ç–∞
                    const data = {
                        action: 'send_email',
                        email: email,
                        asset_type: selectedAsset,
                        timestamp: new Date().toISOString()
                    };
                    
                    tg.sendData(JSON.stringify(data));
                    
                    // Haptic feedback
                    if (tg.HapticFeedback) {
                        tg.HapticFeedback.impactOccurred('medium');
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö (–±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º)
                    showResult('email_requested', email);
                } else {
                    // Fallback –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
                    await simulateEmailSending(email);
                    showResult('email', email);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                stats.emails++;
                saveStats();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
                showResult('error');
                
                if (isInTelegram && tg.HapticFeedback) {
                    tg.HapticFeedback.notificationOccurred('error');
                }
            } finally {
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                sendBtn.classList.remove('hidden');
                loading.classList.add('hidden');
            }
        }

        // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email (–¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞)
        function simulateEmailSending(email) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (Math.random() > 0.1) {
                        resolve();
                    } else {
                        reject(new Error('Network error'));
                    }
                }, 2000);
            });
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è email
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        function showResult(type, email = '') {
            currentStep = 3;
            showStep(3);
            
            const resultDiv = document.getElementById('resultMessage');
            const asset = ASSETS[selectedAsset];
            
            if (type === 'download') {
                resultDiv.innerHTML = `
                    <div class="success-box">
                        <h3>‚úÖ –î–æ–∫—É–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è!</h3>
                        <p><strong>–ê–∫—Ç–∏–≤:</strong> ${asset.title}</p>
                        <p><strong>–§–∞–π–ª:</strong> ${asset.filename} (DOCX)</p>
                        <p><strong>üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</strong></p>
                        <p><small>üí° –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–ª—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –æ–∫–æ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ</small></p>
                        ${isInTelegram ? '<p><small>üì± Telegram –±–æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω –æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏</small></p>' : ''}
                    </div>
                `;
            } else if (type === 'email_requested') {
                resultDiv.innerHTML = `
                    <div class="success-box">
                        <h3>üì§ –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –±–æ—Ç—É!</h3>
                        <p><strong>Email:</strong> ${email}</p>
                        <p><strong>–ê–∫—Ç–∏–≤:</strong> ${asset.title}</p>
                        <p>ü§ñ Telegram –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–∞—à –∑–∞–ø—Ä–æ—Å...</p>
                        <p>üìß –î–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç—ã!</p>
                        <p>üí¨ –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —á–∞—Ç–µ</p>
                    </div>
                `;
            } else if (type === 'email') {
                resultDiv.innerHTML = `
                    <div class="success-box">
                        <h3>‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!</h3>
                        <p><strong>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</strong> ${email}</p>
                        <p><strong>–ê–∫—Ç–∏–≤:</strong> ${asset.title}</p>
                        <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–∏—Å—å–º–∞ (–∏ –ø–∞–ø–∫—É "–°–ø–∞–º").</p>
                        <p>–ü–∏—Å—å–º–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç.</p>
                    </div>
                `;
            } else if (type === 'error') {
                resultDiv.innerHTML = `
                    <div class="error-box">
                        <h3>‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏</h3>
                        <p>–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å email. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>
                        <ul>
                            <li>–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º</li>
                            <li>–ù–µ–≤–µ—Ä–Ω—ã–π email –∞–¥—Ä–µ—Å</li>
                            <li>–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–µ—Ä–≤–µ—Ä–∞</li>
                        </ul>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–∞—á–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é.</p>
                    </div>
                `;
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –∫–Ω–æ–ø–æ–∫
            if (isInTelegram) {
                tg.MainButton.hide();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ó–∞–∫—Ä—ã—Ç—å" –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥
                tg.BackButton.show();
                tg.BackButton.onClick(() => {
                    tg.close();
                });
            }
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function restart() {
            currentStep = 1;
            selectedAsset = null;
            showStep(1);
            hideEmailForm();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –∫–Ω–æ–ø–æ–∫
            if (isInTelegram) {
                tg.MainButton.hide();
                tg.BackButton.hide();
            }

            // Haptic feedback
            if (isInTelegram && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function saveStats() {
            localStorage.setItem('docsStats', JSON.stringify(stats));
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–º–æ—â–∏ –≤ Telegram
        function requestHelp() {
            if (isInTelegram) {
                tg.sendData(JSON.stringify({
                    action: 'need_help',
                    current_step: currentStep,
                    selected_asset: selectedAsset,
                    timestamp: new Date().toISOString()
                }));
                
                tg.showPopup({
                    title: 'üÜò –ü–æ–º–æ—â—å',
                    message: '–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–º–æ—â—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ù–∞—à–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã —Å–≤—è–∂—É—Ç—Å—è —Å –≤–∞–º–∏ –≤ —á–∞—Ç–µ.',
                    buttons: [{type: 'ok'}]
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', init);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π Telegram Web App
        if (isInTelegram) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –≤ Telegram
            tg.onEvent('backButtonClicked', () => {
                if (currentStep > 1) {
                    goBack();
                } else {
                    tg.close();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
            tg.onEvent('viewportChanged', () => {
                console.log('Viewport –∏–∑–º–µ–Ω–∏–ª—Å—è:', tg.viewportHeight);
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã
            if (tg.colorScheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è "–≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"
            tg.ready();
            
            console.log('Telegram Web App —Å–æ–±—ã—Ç–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã');
        }

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.debugTelegram = function() {
            if (isInTelegram) {
                console.log('=== Telegram Web App Debug ===');
                console.log('isInTelegram:', isInTelegram);
                console.log('tg.initData:', tg.initData);
                console.log('tg.initDataUnsafe:', tg.initDataUnsafe);
                console.log('tg.version:', tg.version);
                console.log('tg.platform:', tg.platform);
                console.log('tg.colorScheme:', tg.colorScheme);
                console.log('tg.themeParams:', tg.themeParams);
                console.log('tg.isExpanded:', tg.isExpanded);
                console.log('tg.viewportHeight:', tg.viewportHeight);
                console.log('tg.viewportStableHeight:', tg.viewportStableHeight);
            } else {
                console.log('–ù–µ –≤ Telegram Web App');
            }
        };
    </script>
</body>
</html>
